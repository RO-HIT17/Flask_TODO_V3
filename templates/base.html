<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link id="light-theme" rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link id="dark-theme" rel="stylesheet" href="{{ url_for('static', filename='dark-index.css') }}" disabled>
    <title>TODO Application</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="logout-container">
                <a href="{{ url_for('main') }}" class="icon-link">
            <i class="fas fa-sign-out-alt"></i> Logout
        </a>
    </div>
    <div class="dashboard-container">
                <a href="{{ url_for('dashboard', user_id=user_id) }}" class="icon-link">
            <i class="fas fa-tachometer-alt"></i> Dashboard
        </a>
    </div>
    <button id="theme-toggle" class="toggle-theme">Switch to Dark Theme</button>

    <div class="container">
        {% block content %}{% endblock %}
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggleButton = document.getElementById('theme-toggle');
            const lightThemeLink = document.getElementById('light-theme');
            const darkThemeLink = document.getElementById('dark-theme');

            // Load saved theme preference from localStorage if available
            if (localStorage.getItem('theme') === 'dark') {
                darkThemeLink.removeAttribute('disabled');
                lightThemeLink.setAttribute('disabled', 'disabled');
                themeToggleButton.textContent = 'Switch to Light Theme';
            }

            themeToggleButton.addEventListener('click', function() {
                if (darkThemeLink.disabled) {
                    // Switch to dark theme
                    darkThemeLink.removeAttribute('disabled');
                    lightThemeLink.setAttribute('disabled', 'disabled');
                    localStorage.setItem('theme', 'dark');
                    themeToggleButton.textContent = 'Switch to Light Theme';
                } else {
                    // Switch to light theme
                    lightThemeLink.removeAttribute('disabled');
                    darkThemeLink.setAttribute('disabled', 'disabled');
                    localStorage.setItem('theme', 'light');
                    themeToggleButton.textContent = 'Switch to Dark Theme';
                }
            });

            // Set default date
            var today = new Date();
            var day = String(today.getDate()).padStart(2, '0');
            var month = String(today.getMonth() + 1).padStart(2, '0'); // Months are 0-based in JavaScript
            var year = today.getFullYear();
            var todayDate = year + '-' + month + '-' + day;
            var deadlineDateInput = document.getElementById('deadlineDate');
            if (deadlineDateInput) {
                deadlineDateInput.value = todayDate;
            }
        });
    </script>
</body>
</html>
